<div class= "container mt-3">
  <%= form_tag hikes_path, method: :get do %>
    <div class= "row mt-3">
      <div class= "col-lg-1
      ">
        <div class="nav-link" >
          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fas fa-sliders-h"></i> Price
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <div class="dropdown-item">
                <form method="post">
                  <div data-role="rangeslider">
                      <div class = "container">
                        <span id=></span>
                      <div>
                          <label for="min">400</label>
                          <input type ="range" min="400" max="800" step="25" onchange="showVal('price-output', this.value)"/>
                          <label for="max">800</label>
                        </div>
                        <output id="price-output'">500</output>
                     </div>
                    </div>
                  </div>
                </div>
            </div>
          </div>
        </div>
        <div class= "col-lg-1
        ">
          <div class="nav-link" >
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Difficulty
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <div class="dropdown-item">
                  <%= check_box_tag "difficulty[]", "beginner" %>
                  <%= label_tag :beginner %>
                  <br>
                  <%= check_box_tag "difficulty[]", "intermediate" %>
                  <%= label_tag :intermediate %>
                  <br>
                  <%= check_box_tag "difficulty[]", "expert" %>
                  <%= label_tag :expert %>
                  <br>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class= "col-lg-1
        ">
          <div class="nav-link" >
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Duration
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <div class="dropdown-item">
                  <form method="post">
                    <div data-role="rangeslider">
                      <div class = "container">
                        <div>
                          <label for="min">1</label>
                          <input type ="range" min="1" max="9" onchange="showVal('duration-output', this.value)"/>
                          <label for="max">9</label>
                        </div>
                        <output id="duration-output">4</output>
                     </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class= "col-lg-1
          ">
            <div class="nav-link" >
              <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Distance
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <div class="dropdown-item">
                    <form method="post">

                        <div>
                          <label for="min">14</label>
                          <input type ="range" min="14" max="60" onchange="showVal('distance-output', this.value)"/>
                          <label for="max">60</label>
                          </div>
                          <output id="distance-output">20</output
                        </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class= "col-lg-1
            ">
              <div class="nav-link" >
                <div class="dropdown">
                  <div style="width:500px;">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Accomodation
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <div class="dropdown-item">
                        <br>
                        <%= check_box_tag "accomodation[]", "cabin" %>
                        <%= label_tag :cabin %>
                        <br>
                        <%= check_box_tag "accomodation[]", "tent" %>
                        <%= label_tag :tent %>
                        <br>
                        <%= check_box_tag "accomodation[]", "tipi" %>
                        <%= label_tag :tipi %>
                        <br>
                        <%= check_box_tag "accomodation[]", "under the stars" %>
                        <%= label_tag :under_the_stars %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class= "col-lg-1
            ">
              <%= submit_tag "Search", class: "btn btn-primary-search" %>
            </div>
          <% end %>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-10">
            <div class="hike_results">Hike Results:</div>
          </div>
          <div clas="col-lg-1"><button class="btn active"><i class="fas fa-list"></i></button></div>
          <div clas="col-lg-1"><button class="btn active"><i class="far fa-map"></i></button></div>
        </div>
        <% @hikes.each do |hike| %>
          <% if hike.photos.attached? %>
            <%= link_to hike_path(hike), class:'text-decoration-none' do %>
              <div class = "col-lg-12">
                <div class="card-product">
                  <%= cl_image_tag hike.photos.first.key, class: 'hike-image' %>
                  <div class="card-product-infos">
                    <div class="card-product-infos-heading">
                      <div class ="nome_hike"><%= hike.name %></div>
                      <div class ="prezzo">$<%=hike.price%></div>
                    </div>
                    <div class="card-product-infos-subheading">
                      <div class="luogo"><%= hike.region %></div>
                      <div class="reviews"><i class="fas fa-star"></i> /
                        <% @rating = hike.reviews.map { |r| r.rating} %>
                        <%= (@rating.inject{ |sum, el| sum + el }.to_f / @rating.size).round(2)  %>
                      </div>
                    </div>
                    <div><i class="far fa-clock"></i> <%= hike.length %> Days</div>
                    <div><i class="fas fa-arrow-right"></i> <%= hike.distance %> Kilometers</div>
                    <div><i class="fas fa-arrow-up"></i> <%= hike.elevation %>m Elevation</div>
                    <div class="button difficolta"><%= hike.difficulty %></div>
                    <br>
                    <div class="card-product-infos-last-row">
                      <div class="availability">
                        Available in: <%= hike.group_hikes.map { |gh| gh.start_at.strftime("%B") }.uniq.join(', ') %>
                      </div>
                      <%= link_to toggle_favorite_hike_path(hike), remote: true, method: :post do %>
                        <div class="like-icon mx-2 heart <%= 'not-favorited' unless current_user.favorited?(hike) %>" data-id="<%= hike.id %>">
                          <i class="fas fa-heart"></i></div>
                      <% end %>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          <% else %>
            <%= link_to hike_path(hike), class:'text-decoration-none' do %>
              <div class = "col-lg-12">
                <div class="card-product">
                  <img src="https://images.unsplash.com/photo-1511225070737-5af5ac9a690d?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80" />
                  <div class="card-product-infos">
                    <div class="card-product-infos-heading">
                      <div class ="nome_hike"><%= hike.name %></div>
                      <div class ="prezzo">$<%=hike.price%></div>
                      <%= link_to toggle_favorite_hike_path(hike), remote: true, method: :post do %>
                        <div class="like-icon mx-2 heart <%= 'not-favorited' unless current_user.favorited?(hike) %>" data-id="<%= hike.id %>">
                          <i class="fas fa-heart"></i></div>
                      <% end %>
                    </div>
                    <div class="card-product-infos-subheading">
                      <div class="luogo"><%= hike.region %></div>
                      <div class="reviews"><i class="fas fa-star"></i> /5.00</div>
                    </div>
                    <div><i class="far fa-clock"></i> <%= hike.length %> Days</div>
                    <div><i class="fas fa-arrow-right"></i> <%= hike.distance %> Kilometers</div>
                    <div><i class="fas fa-arrow-up"></i> <%= hike.elevation %>m Elevation</div>
                    <div class="button difficolta"><%= hike.difficulty %></div>
                    <br>
                    <div class="card-product-infos-last-row">
                      <div class="availability">This hike is available during the months of June, July, August, September</div>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
      <div class="container">
        <div class = "row">
          <div class="col-lg-12">
            <div id="map"
          style="width: 100%; height: 600px;"
          data-markers="<%= @markers.to_json %>"
          data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
            </div>
          </div>
        </div>
      </div>

